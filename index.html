
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DCS Typing Practice</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background-color: #f0f0f0; text-align: center; }
    h1 { font-size: 2em; margin-bottom: 0.5em; }
    textarea, #typing-area { width: 80%; padding: 10px; font-size: 18px; margin-bottom: 20px; }
    #keyboard { display: flex; flex-direction: column; gap: 5px; margin: 0 auto 20px; width: max-content; max-width: 100%; }
    .row { display: flex; gap: 5px; justify-content: center; }
    .key { padding: 10px; border: 1px solid #ccc; text-align: center; font-size: 18px; border-radius: 4px; min-width: 32px; }
    .spacebar { min-width: 300px; }
    .highlight { background-color: black !important; color: white !important; }
    .toggle-container { margin-bottom: 10px; }
    #message { font-weight: bold; font-size: 20px; color: green; }
    #feedback { font-weight: bold; color: red; margin-top: 10px; }
    #results { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>DCS Typing Practice</h1>
  <div id="intro-text">
    <p>Welcome! Enter a sentence for the student to type. The program will guide them letter by letter.</p>
    <p>After you click "Start Typing," the student will hear each prompt and see which key to press next. If they press the wrong key, the program will give immediate feedback. Accuracy and WPM will be shown at the end, and a summary can be printed.</p>
  </div>
  <button id="start-button" onclick="initApp()">Click to Start</button>
  <div id="app" style="display:none;">
    <textarea id="custom-text" rows="3" placeholder="Type your practice sentence here..."></textarea><br>
    <button onclick="startTyping()">Start Typing</button>
    <div class="toggle-container">
      <label><input type="checkbox" id="case-toggle" onchange="createKeyboard()"> Show lowercase letters</label>
    </div>
    <div class="toggle-container">
      <label><input type="checkbox" id="audio-toggle" checked> Audio Prompts</label>
    </div>
    <input id="typing-area" disabled onkeydown="return false;">
    <div id="keyboard"></div>
    <p id="message"></p>
    <p id="feedback"></p>
    <div id="results"></div>
  </div>

  <audio id="success-sound">
    <source src="https://actions.google.com/sounds/v1/human_voices/kids_cheer.ogg" type="audio/ogg">
    <source src="https://actions.google.com/sounds/v1/human_voices/kids_cheer.mp3" type="audio/mpeg">
  </audio>
  <audio id="error-sound">
    <source src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg" type="audio/ogg">
    <source src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.mp3" type="audio/mpeg">
  </audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script>
    console.log("Script loaded!");

    function initApp() {
      console.log("initApp() called");
      document.getElementById("start-button").style.display = "none";
      document.getElementById("intro-text").style.display = "none";
      document.getElementById("app").style.display = "block";
      createKeyboard();
    }

    function createKeyboard() {
      const keyboard = document.getElementById("keyboard");
      const lowercase = document.getElementById("case-toggle").checked;
      const layout = [
        ["tab","q","w","e","r","t","y","u","i","o","p"],
        ["caps lock","a","s","d","f","g","h","j","k","l"],
        ["shift","z","x","c","v","b","n","m",".",",","!","?"],
        ["ctrl","option","command"," ","command","option"]
      ];
      keyboard.innerHTML = "";
      layout.forEach(row => {
        const rowDiv = document.createElement("div");
        rowDiv.className = "row";
        row.forEach(key => {
          const keyDiv = document.createElement("div");
          keyDiv.className = "key";
          keyDiv.textContent = key === " " ? "Space" : (lowercase ? key : key.toUpperCase());
          keyDiv.id = `key-${key === " " ? "space" : key.replace(/[^a-z0-9]/gi, '').toLowerCase()}`;
          if (key === " ") keyDiv.classList.add("spacebar");
          rowDiv.appendChild(keyDiv);
        });
        keyboard.appendChild(rowDiv);
      });
    }

    function startTyping() {
      console.log("startTyping() called");
      const text = document.getElementById("custom-text").value;
      if (!text) return;
      document.getElementById("typing-area").disabled = false;
      document.getElementById("typing-area").focus();
      document.getElementById("typing-area").value = "";
      document.getElementById("message").textContent = "";
      document.getElementById("feedback").textContent = "";
      document.getElementById("results").textContent = "";
      // Typing functionality could be expanded from here (omitted for brevity)
    }
  </script>
</body>
</html>
